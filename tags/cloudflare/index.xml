<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Cloudflare on Vincent&#39;s Notes</title>
    <link>https://missuo.me/tags/cloudflare/</link>
    <description>Recent content in Cloudflare on Vincent&#39;s Notes</description>
    <image>
      <title>Vincent&#39;s Notes</title>
      <url>https://r2.qwq.mx/blog/20240318CGUAM3.jpg</url>
      <link>https://r2.qwq.mx/blog/20240318CGUAM3.jpg</link>
    </image>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Tue, 30 Jan 2024 14:45:27 -0500</lastBuildDate><atom:link href="https://missuo.me/tags/cloudflare/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Warning of account suspension by Cloudflare</title>
      <link>https://missuo.me/posts/cloudflare-1pb/</link>
      <pubDate>Tue, 30 Jan 2024 14:45:27 -0500</pubDate>
      
      <guid>https://missuo.me/posts/cloudflare-1pb/</guid>
      <description>我收到了 Cloudflare 企业专属客服的邮件，让我加她的联系方式。结果没想到加了之后，才知道我的帐号存在被封号的风险。
这是我每个月的用量，平均每天 50T 流量，每个月达到了 1PB，Unique Visitors 更是达到了 1.4 亿，等于是有十分之一的中国人访问了一次我的网站。
很多网友非常好奇我到底是跑了一个什么项目，怎么样的的一个站点能够达到如此的规模。甚至这几天我的 推文 引来了很多的关注，甚至有人说我把 CF 薅秃了之类的。
我想在这里做一些解释，这个网站甚至没几行代码。只有一个 HTML 文件，加上 Nginx 的反向代理。从我的 Commit 记录来看，最早是 2021 年 2 月，已经是三年前了。
主要做的是非常简单的事情，就是通过 Nginx 反向代理了 Telegraph。这样就可以匿名地上传无限量的图片，虽然有每张图 5M 的限制，但也够用。我自己用的不多，我博客的图片都在 Cloudflare R2。
为了方便网友尝试，我开放了一个公共站点，即公共图床，方便大家去试用。这个站点没有任何的广告，没有任何的收益。过去的三年，每个月也就不超过 10TB 的流量，很正常的浏览量。而在 2023 年 11 月-12 月左右，开始变得越来越疯狂了，我发现每日的流量从 30T 到 50T。本来我也不管，因为其实我的成本只是贡献了一个域名，一台服务器，更何况缓存率是 99.98%，我的服务器本身并不会产生很多的流量。
直到我收到了 Cloudflare 的邮件，我才意识到我应该处理一下这样子的滥用行为，第一时间我将域名解析到了 1.1.1.1，暂停了使用。之后我去检查了一下 Nginx 的访问日志，这让我震惊。
随意找到了一张图片，或者是 Origin 的站点，毫无疑问 99% 都是中文色情网站。这让我感到失望，初衷是希望大家可以利用这个公共图床写写博客或者是分享一些有趣的图片，而不是用来传播色情。而很夸张的是，我发现知名的色情论坛，t66y 也在使用我的图床，甚至有些用户的头像用的正是我的域名。
为了防止被滥用，我修改了一些 Nginx 的配置，例如我限制了一些图片格式，限制了 Origin。24 小时内流量从 50T 降到了 不到 4T。我也在 Cloudflare 的控制面板上设置了一些规则。</description>
      <content:encoded><![CDATA[<blockquote>
<p>我收到了 Cloudflare 企业专属客服的邮件，让我加她的联系方式。结果没想到加了之后，才知道我的帐号存在被封号的风险。</p>
</blockquote>
<p><img loading="lazy" src="https://r2.qwq.mx/blog/20240130RZBNSl.png" alt="20240130RZBNSl"  />
</p>
<p><img loading="lazy" src="https://r2.qwq.mx/blog/20240130Qda0ck.png" alt="20240130Qda0ck"  />
</p>
<p><strong>这是我每个月的用量，平均每天 50T 流量，每个月达到了 1PB，Unique Visitors 更是达到了 1.4 亿，等于是有十分之一的中国人访问了一次我的网站。</strong></p>
<p>很多网友非常好奇我到底是跑了一个什么项目，怎么样的的一个站点能够达到如此的规模。甚至这几天我的 <a href="https://x.com/m1ssuo/status/1751810633786331166">推文</a> 引来了很多的关注，甚至有人说我把 CF 薅秃了之类的。</p>
<p>我想在这里做一些解释，这个网站甚至没几行代码。只有一个 HTML 文件，加上 Nginx 的反向代理。从我的 Commit 记录来看，最早是 2021 年 2 月，已经是三年前了。</p>
<p>主要做的是非常简单的事情，就是通过 Nginx 反向代理了 <a href="https://telegra.ph">Telegraph</a>。这样就可以匿名地上传无限量的图片，虽然有每张图 5M 的限制，但也够用。我自己用的不多，我博客的图片都在 Cloudflare R2。</p>
<p>为了方便网友尝试，我开放了一个公共站点，即公共图床，方便大家去试用。这个站点没有任何的广告，没有任何的收益。过去的三年，每个月也就不超过 10TB 的流量，很正常的浏览量。而在 2023 年 11 月-12 月左右，开始变得越来越疯狂了，我发现每日的流量从 30T 到 50T。本来我也不管，因为其实我的成本只是贡献了一个域名，一台服务器，更何况缓存率是 99.98%，我的服务器本身并不会产生很多的流量。</p>
<p>直到我收到了 Cloudflare 的邮件，我才意识到我应该处理一下这样子的滥用行为，第一时间我将域名解析到了 <strong>1.1.1.1</strong>，暂停了使用。之后我去检查了一下 Nginx 的访问日志，这让我震惊。</p>
<p><img loading="lazy" src="https://r2.qwq.mx/blog/202401302SLp2n.png" alt="202401302SLp2n"  />
</p>
<p>随意找到了一张图片，或者是 Origin 的站点，毫无疑问 99% 都是中文色情网站。这让我感到失望，初衷是希望大家可以利用这个公共图床写写博客或者是分享一些有趣的图片，而不是用来传播色情。而很夸张的是，我发现知名的色情论坛，t66y 也在使用我的图床，甚至有些用户的头像用的正是我的域名。</p>
<p>为了防止被滥用，我修改了一些 Nginx 的配置，例如我限制了一些图片格式，限制了 Origin。24 小时内流量从 50T 降到了 不到 4T。我也在 Cloudflare 的控制面板上设置了一些规则。</p>
<p>我的好朋友 <a href="https://twitter.com/steveyiyo">SteveYi</a> 也在第一时间私信我，愿意提供 VM。在这里特别感谢小易。直到目前为止，已经迁移到加州的 100Gbps 带宽的服务器，不再依赖 Cloudflare。</p>
<p><img loading="lazy" src="https://r2.qwq.mx/blog/202401308yg7H3.png" alt="202401308yg7H3"  />
</p>
<p><img loading="lazy" src="https://r2.qwq.mx/blog/202402024GReqq.png" alt="202402024GReqq"  />
</p>
<p><strong>突破了 4Gbps 的入站和出站流量，流量顶峰的时候可以跑满 20Gbps 的带宽。</strong></p>
<p>我不知道还能支撑多久，毕竟这样的公益图床站点没有收益，而且还要承担很大的风险，也许有一天会永久关闭，且用且珍惜吧。</p>
<p>感谢 Telegraph 和 Cloudflare 过去提供的免费服务。</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Unlock ChatGPT with Cloudflare WARP</title>
      <link>https://missuo.me/posts/cloudflare-warp-chatgpt/</link>
      <pubDate>Sat, 11 Feb 2023 13:33:35 +0800</pubDate>
      
      <guid>https://missuo.me/posts/cloudflare-warp-chatgpt/</guid>
      <description>原理分析 Cloudflare WARP 拥有很多 IP，而 ChatGPT 的 CDN 又是 Cloudflare 提供的，也就是说，能不能访问完全取决于 Cloudflare。因此使用 Cloudflare 自己的 IP 大概率不会被 Ban。除了 WARP 之外，iCloud Private Relay 也是 Cloudflare 的 IP 哦。
具体步骤 本文的方案仅改变 IPv6 出口 IP，不会改变 IPv4 出口 IP，更不会改变路由。
准备一台 VPS，需要是 OpenGPT 支持的 161 个国家之一。因为你的网络在哪里，WARP 就会使用你所在地的 IP。比如香港就不行。 Supported countries and territories
使用以下命令安装 WARP。 bash &amp;lt;(curl -fsSL git.io/warp.sh) proxy 配置 XrayR/V2Ray 的出站规则和路由。（以 XrayR 为例，XrayR/V2Ray 的使用本文略过） # custom_outbound.json { &amp;#34;tag&amp;#34;: &amp;#34;socks5-warp&amp;#34;, &amp;#34;protocol&amp;#34;: &amp;#34;socks&amp;#34;, &amp;#34;settings&amp;#34;: { &amp;#34;servers&amp;#34;: [{ &amp;#34;address&amp;#34;: &amp;#34;127.</description>
      <content:encoded><![CDATA[<h2 id="原理分析">原理分析</h2>
<p><strong>Cloudflare WARP</strong> 拥有很多 IP，而 ChatGPT 的 CDN 又是 Cloudflare 提供的，也就是说，能不能访问完全取决于 Cloudflare。因此使用 Cloudflare 自己的 IP 大概率不会被 Ban。除了 WARP 之外，iCloud Private Relay 也是 Cloudflare 的 IP 哦。</p>
<h2 id="具体步骤">具体步骤</h2>
<p><strong>本文的方案仅改变 IPv6 出口 IP，不会改变 IPv4 出口 IP，更不会改变路由。</strong></p>
<ol>
<li>准备一台 VPS，需要是 OpenGPT 支持的 161 个国家之一。因为你的网络在哪里，WARP 就会使用你所在地的 IP。比如香港就不行。</li>
</ol>
<p><a href="https://platform.openai.com/docs/supported-countries">Supported countries and territories</a></p>
<ol start="2">
<li>使用以下命令安装 WARP。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bash &lt;(curl -fsSL git.io/warp.sh) proxy
</span></span></code></pre></div><ol start="3">
<li>配置 XrayR/V2Ray 的出站规则和路由。（以 XrayR 为例，XrayR/V2Ray 的使用本文略过）</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">#</span> <span class="err">custom_outbound.json</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;socks5-warp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;socks&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;servers&#34;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;address&#34;</span><span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;port&#34;</span><span class="p">:</span> <span class="mi">40000</span>
</span></span><span class="line"><span class="cl">        <span class="p">}]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="err">route.json</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;field&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;outboundTag&#34;</span><span class="p">:</span> <span class="s2">&#34;socks5-warp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;ip&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;::/0&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>简单解释一下，出站规则是指出站走 40000 端口的 SOCKS 代理。路由规则是指所有 IPv6 出站均走 SOCKS 代理。</p>
<ol start="4">
<li>如果你只是想让 OpenAI 走 WARP 的 IPv6，可以这样写。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">#</span> <span class="err">route.json</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;field&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;outboundTag&#34;</span><span class="p">:</span> <span class="s2">&#34;socks5-warp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;domain&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;openai.com&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
  </channel>
</rss>
