<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Discord | Vincent's Notes</title>
<meta name=keywords content><meta name=description content="Record, Share and Archive"><meta name=author content="Vincent Young"><link rel=canonical href=https://missuo.me/tags/discord/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><link rel=icon href=https://r2.qwq.mx/blog/20230104uZXT8s.ico><link rel=icon type=image/png sizes=16x16 href=https://r2.qwq.mx/blog/20230104uZXT8s.ico><link rel=icon type=image/png sizes=32x32 href=https://r2.qwq.mx/blog/20230104uZXT8s.ico><link rel=apple-touch-icon href=https://r2.qwq.mx/blog/20230104uZXT8s.ico><link rel=mask-icon href=https://r2.qwq.mx/blog/20230104uZXT8s.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://missuo.me/tags/discord/index.xml><link rel=alternate hreflang=en href=https://missuo.me/tags/discord/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Discord"><meta property="og:description" content="Record, Share and Archive"><meta property="og:type" content="website"><meta property="og:url" content="https://missuo.me/tags/discord/"><meta property="og:image" content="https://r2.qwq.mx/blog/20240331dCkqHY.jpg"><meta property="og:site_name" content="Vincent's Notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://r2.qwq.mx/blog/20240331dCkqHY.jpg"><meta name=twitter:title content="Discord"><meta name=twitter:description content="Record, Share and Archive"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://missuo.me/ accesskey=h title="Vincent's Notes (Alt + H)">Vincent's Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://missuo.me/ title=Home><span>Home</span></a></li><li><a href=https://missuo.me/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://missuo.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://missuo.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://missuo.me/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>Discord
<a href=/tags/discord/index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>File Sharing via Discord Bot</h2></header><div class=entry-content><p>用过 Discord 的朋友应该知道，在任何的 Server 里面发的图片，音频，视频以及别的任何文件，都会生成一个以 https://cdn.discordapp.com/attachments/ 开头的链接。这个链接是可以直接访问的，但是不幸的是这个链接会在 24 小时后失效。但是只要每 24 小时获取一次最新的链接，应该就可以利用这一点来实现图床或者是文件共享的功能。
Discord 似乎个人账户是不存在 API 的，但是可以随意地创建 Bot，我们只要创建一个 Bot，然后把 Bot 添加到你自己私有的 Server 之后，给 Bot 赋予发送消息和媒体文件的权限，就可以通过 API 接收文件，然后再通过 Bot 发送文件到 Channel 里面。
这里我使用 Go 来实现这个功能，首先我们需要一个 Bot 的 Token，这个 Token 可以在 Discord Developer Portal 里面创建一个 Bot 之后获取到。
在 https://github.com/missuo/discord-image 的设计中，每次上传完文件（以图片为例），并不会直接返回 Discord 的链接，而是返回一个 https://example.com/file/{message_id} 的链接，/file 是一个 API，每次请求这个 API 都会去 Discord 获取最新的链接，然后返回给用户。这样就实现了链接用不失效的效果。
除此之外，由于 cdn.discordapp.com 在中国大陆已经被 GFW 封锁，但是关于这个问题，可以用简单的 Nginx Reverse Proxy 或者是 Cloudflare Worker 来解决。
比起我之前分享过的 Telegraph 来说，利用 Discord 支持单文件 25MB，而过去的 Telegraph 只支持 5MB，这样的话，我们就可以利用 Discord 来分享更大的文件。而且 Discord 支持的文件类型更加丰富，过去利用 Telegraph 上传之后是无法进行删除的操作的，而 Discord 可以直接在你的 Channel 直接删除文件。...</p></div><footer class=entry-footer><span title='2024-04-10 20:04:15 -0400 -0400'>Wednesday, April 10, 2024</span>&nbsp;·&nbsp;Vincent Young</footer><a class=entry-link aria-label="post link to File Sharing via Discord Bot" href=https://missuo.me/posts/discord-file-sharing/></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://missuo.me/>Vincent's Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>