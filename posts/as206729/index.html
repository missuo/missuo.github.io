<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ASN Application | Use your own IP to access the Internet | Vincent's Notes</title><meta name=keywords content="ASN,BGP,Bird,Linux,BuyVM"><meta name=description content="ASN是什么 自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。
每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)
每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。
但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？
运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。
既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。
我的ASN信息——AS206729 AS206729 Prefixes v6 2401:95c0:f001::/48
AS206729 Peers v6 Rank Description IPv6 Peer 1 FranTech Solutions 2401:95c0:f001::1/128 AS53667 更多详情，前往BGP.TOOLS查看。 如何申请ASN 一般情况下，需要寻找APNIC或者RIPE的会员来作为你的LIR。当然你也可以自己加入APNIC或者RIPE，需要每年缴纳费用。
我找的是台湾的一个朋友 Hostinginside LTD(AS9678)，他作为我的LIR，申请的是RIPE。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。APNIC可能没那么快。
RIPE准备的材料 注册RIPE账号，新建一些 Database的信息。 你的护照照片 你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱） ISP愿意给你接入BGP的证明 两个需要接入的ASN ASN下号 接入BGP Session（以BuyVM为例，Vultr类似） 发Ticket告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。 在你的VPS上安装bird。用于宣告你的IP。 修改 /etc/bird/bird6.conf的配置文件 修改配置中的 router id 改为自己的IPv4地址 router id 205.121.23.12; 在文件的最后添加上 protocol bgp vultr { local as 你的asn(开头不带as); source address 实例的ipv6; import none; export all; graceful restart on; multihop 2; neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip password &#34;在申请广播的时候设置的bgp密码&#34;; } 寻找到protocol static（没有的话自己加一个） protocol static { route [v6前缀] via [实例的IPv6]; #route 2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c; } 找到protocol direct protocol direct { interface &#34;dummy*&#34;; import all; } 配置虚拟网卡以及ip地址 ip link add dev dummy1 type dummy # 添加虚拟网卡 ip link set dummy1 up ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址 启动bird6 service bird6 restart 查看状态 birdc6 show route birdc6 show proto all 如果想要开机自启 在 /etc/netplan新增01."><meta name=author content="Vincent Young"><link rel=canonical href=https://missuo.me/posts/as206729/><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://static.nisekoo.com/blog/20230104uZXT8s.ico><link rel=icon type=image/png sizes=16x16 href=https://missuo.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://missuo.me/favicon-32x32.png><link rel=apple-touch-icon href=https://missuo.me/apple-touch-icon.png><link rel=mask-icon href=https://missuo.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="ASN Application | Use your own IP to access the Internet"><meta property="og:description" content="ASN是什么 自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。
每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)
每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。
但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？
运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。
既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。
我的ASN信息——AS206729 AS206729 Prefixes v6 2401:95c0:f001::/48
AS206729 Peers v6 Rank Description IPv6 Peer 1 FranTech Solutions 2401:95c0:f001::1/128 AS53667 更多详情，前往BGP.TOOLS查看。 如何申请ASN 一般情况下，需要寻找APNIC或者RIPE的会员来作为你的LIR。当然你也可以自己加入APNIC或者RIPE，需要每年缴纳费用。
我找的是台湾的一个朋友 Hostinginside LTD(AS9678)，他作为我的LIR，申请的是RIPE。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。APNIC可能没那么快。
RIPE准备的材料 注册RIPE账号，新建一些 Database的信息。 你的护照照片 你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱） ISP愿意给你接入BGP的证明 两个需要接入的ASN ASN下号 接入BGP Session（以BuyVM为例，Vultr类似） 发Ticket告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。 在你的VPS上安装bird。用于宣告你的IP。 修改 /etc/bird/bird6.conf的配置文件 修改配置中的 router id 改为自己的IPv4地址 router id 205.121.23.12; 在文件的最后添加上 protocol bgp vultr { local as 你的asn(开头不带as); source address 实例的ipv6; import none; export all; graceful restart on; multihop 2; neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip password &#34;在申请广播的时候设置的bgp密码&#34;; } 寻找到protocol static（没有的话自己加一个） protocol static { route [v6前缀] via [实例的IPv6]; #route 2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c; } 找到protocol direct protocol direct { interface &#34;dummy*&#34;; import all; } 配置虚拟网卡以及ip地址 ip link add dev dummy1 type dummy # 添加虚拟网卡 ip link set dummy1 up ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址 启动bird6 service bird6 restart 查看状态 birdc6 show route birdc6 show proto all 如果想要开机自启 在 /etc/netplan新增01."><meta property="og:type" content="article"><meta property="og:url" content="https://missuo.me/posts/as206729/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-04T05:44:38+00:00"><meta property="article:modified_time" content="2022-04-04T05:44:38+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ASN Application | Use your own IP to access the Internet"><meta name=twitter:description content="ASN是什么 自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。
每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)
每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。
但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？
运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。
既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。
我的ASN信息——AS206729 AS206729 Prefixes v6 2401:95c0:f001::/48
AS206729 Peers v6 Rank Description IPv6 Peer 1 FranTech Solutions 2401:95c0:f001::1/128 AS53667 更多详情，前往BGP.TOOLS查看。 如何申请ASN 一般情况下，需要寻找APNIC或者RIPE的会员来作为你的LIR。当然你也可以自己加入APNIC或者RIPE，需要每年缴纳费用。
我找的是台湾的一个朋友 Hostinginside LTD(AS9678)，他作为我的LIR，申请的是RIPE。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。APNIC可能没那么快。
RIPE准备的材料 注册RIPE账号，新建一些 Database的信息。 你的护照照片 你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱） ISP愿意给你接入BGP的证明 两个需要接入的ASN ASN下号 接入BGP Session（以BuyVM为例，Vultr类似） 发Ticket告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。 在你的VPS上安装bird。用于宣告你的IP。 修改 /etc/bird/bird6.conf的配置文件 修改配置中的 router id 改为自己的IPv4地址 router id 205.121.23.12; 在文件的最后添加上 protocol bgp vultr { local as 你的asn(开头不带as); source address 实例的ipv6; import none; export all; graceful restart on; multihop 2; neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip password &#34;在申请广播的时候设置的bgp密码&#34;; } 寻找到protocol static（没有的话自己加一个） protocol static { route [v6前缀] via [实例的IPv6]; #route 2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c; } 找到protocol direct protocol direct { interface &#34;dummy*&#34;; import all; } 配置虚拟网卡以及ip地址 ip link add dev dummy1 type dummy # 添加虚拟网卡 ip link set dummy1 up ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址 启动bird6 service bird6 restart 查看状态 birdc6 show route birdc6 show proto all 如果想要开机自启 在 /etc/netplan新增01."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://missuo.me/posts/"},{"@type":"ListItem","position":3,"name":"ASN Application | Use your own IP to access the Internet","item":"https://missuo.me/posts/as206729/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ASN Application | Use your own IP to access the Internet","name":"ASN Application | Use your own IP to access the Internet","description":"ASN是什么 自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。\n每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)\n每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。\n但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？\n运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。\n既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。\n我的ASN信息——AS206729 AS206729 Prefixes v6 2401:95c0:f001::/48\nAS206729 Peers v6 Rank Description IPv6 Peer 1 FranTech Solutions 2401:95c0:f001::1/128 AS53667 更多详情，前往BGP.TOOLS查看。 如何申请ASN 一般情况下，需要寻找APNIC或者RIPE的会员来作为你的LIR。当然你也可以自己加入APNIC或者RIPE，需要每年缴纳费用。\n我找的是台湾的一个朋友 Hostinginside LTD(AS9678)，他作为我的LIR，申请的是RIPE。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。APNIC可能没那么快。\nRIPE准备的材料 注册RIPE账号，新建一些 Database的信息。 你的护照照片 你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱） ISP愿意给你接入BGP的证明 两个需要接入的ASN ASN下号 接入BGP Session（以BuyVM为例，Vultr类似） 发Ticket告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。 在你的VPS上安装bird。用于宣告你的IP。 修改 /etc/bird/bird6.conf的配置文件 修改配置中的 router id 改为自己的IPv4地址 router id 205.121.23.12; 在文件的最后添加上 protocol bgp vultr { local as 你的asn(开头不带as); source address 实例的ipv6; import none; export all; graceful restart on; multihop 2; neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip password \u0026#34;在申请广播的时候设置的bgp密码\u0026#34;; } 寻找到protocol static（没有的话自己加一个） protocol static { route [v6前缀] via [实例的IPv6]; #route 2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c; } 找到protocol direct protocol direct { interface \u0026#34;dummy*\u0026#34;; import all; } 配置虚拟网卡以及ip地址 ip link add dev dummy1 type dummy # 添加虚拟网卡 ip link set dummy1 up ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址 启动bird6 service bird6 restart 查看状态 birdc6 show route birdc6 show proto all 如果想要开机自启 在 /etc/netplan新增01.","keywords":["ASN","BGP","Bird","Linux","BuyVM"],"articleBody":"ASN是什么 自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。\n每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)\n每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。\n但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？\n运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。\n既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。\n我的ASN信息——AS206729 AS206729 Prefixes v6 2401:95c0:f001::/48\nAS206729 Peers v6 Rank Description IPv6 Peer 1 FranTech Solutions 2401:95c0:f001::1/128 AS53667 更多详情，前往BGP.TOOLS查看。 如何申请ASN 一般情况下，需要寻找APNIC或者RIPE的会员来作为你的LIR。当然你也可以自己加入APNIC或者RIPE，需要每年缴纳费用。\n我找的是台湾的一个朋友 Hostinginside LTD(AS9678)，他作为我的LIR，申请的是RIPE。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。APNIC可能没那么快。\nRIPE准备的材料 注册RIPE账号，新建一些 Database的信息。 你的护照照片 你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱） ISP愿意给你接入BGP的证明 两个需要接入的ASN ASN下号 接入BGP Session（以BuyVM为例，Vultr类似） 发Ticket告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。 在你的VPS上安装bird。用于宣告你的IP。 修改 /etc/bird/bird6.conf的配置文件 修改配置中的 router id 改为自己的IPv4地址 router id 205.121.23.12; 在文件的最后添加上 protocol bgp vultr { local as 你的asn(开头不带as); source address 实例的ipv6; import none; export all; graceful restart on; multihop 2; neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip password \"在申请广播的时候设置的bgp密码\"; } 寻找到protocol static（没有的话自己加一个） protocol static { route [v6前缀] via [实例的IPv6]; #route 2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c; } 找到protocol direct protocol direct { interface \"dummy*\"; import all; } 配置虚拟网卡以及ip地址 ip link add dev dummy1 type dummy # 添加虚拟网卡 ip link set dummy1 up ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址 启动bird6 service bird6 restart 查看状态 birdc6 show route birdc6 show proto all 如果想要开机自启 在 /etc/netplan新增01.dummy.yaml network: version: 2 renderer: networkd bridges: dummy0: dhcp4: no dhcp6: no accept-ra: no interfaces: [ ] addresses: - 2401:95c0:f001::1/128 #你的IP 配置XrayR的出站路由 { \"domainStrategy\": \"IPOnDemand\", \"rules\": [ { \"type\": \"field\", \"outboundTag\": \"block\", \"ip\": [ \"geoip:private\" ] }, { \"type\": \"field\", \"outboundTag\": \"block\", \"protocol\": [ \"bittorrent\" ] }, # 指定域名走我自己的IP { \"type\": \"field\", \"outboundTag\": \"bgp_session\", \"domain\": [\"ipv6.ip.sb\"] }, # Netflix和YouTube走我自己的IP { \"type\": \"field\", \"outboundTag\": \"bgp_session\", \"domain\": [ \"geosite:netflix\", \"geosite:youtube\" ] } ] } ##上网测试\nIP.SB Netflix（解锁台湾NF所有片源） YouTube（支持Premium TW） 参考文章 年轻人的第一个私人BGP(二) - 广播你的IP\nIP 广播: 使用bird广播(组播)ipv6\n","wordCount":"229","inLanguage":"en","datePublished":"2022-04-04T05:44:38Z","dateModified":"2022-04-04T05:44:38Z","author":{"@type":"Person","name":"Vincent Young"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://missuo.me/posts/as206729/"},"publisher":{"@type":"Organization","name":"Vincent's Notes","logo":{"@type":"ImageObject","url":"https://static.nisekoo.com/blog/20230104uZXT8s.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://missuo.me accesskey=h title="Vincent's Notes (Alt + H)">Vincent's Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://missuo.me/ title=Home><span>Home</span></a></li><li><a href=https://missuo.me/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://missuo.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://missuo.me/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>ASN Application | Use your own IP to access the Internet</h1><div class=post-meta><span title='2022-04-04 05:44:38 +0000 UTC'>April 4, 2022</span>&nbsp;·&nbsp;Vincent Young</div></header><div class=post-content><h2 id=asn是什么>ASN是什么<a hidden class=anchor aria-hidden=true href=#asn是什么>#</a></h2><blockquote><p>自治系统(Autonomous System)，用通俗的语言来形容，就是一个互联网的独立王国，这一个个独立王国互联起来，就组成了互联网(Internet)。</p></blockquote><blockquote><p>每个王国有自己独立的国号，以区别于别的王国，这个国号用自治系统号ASN(Autonomous System Number)，ASN由两个字节组成，理论上取值范围为1-65535，末尾的1024个ASN是私有自治号，用于王国内部的下属郡国使用，不能外泄（类似私有IP，如果不小心外泄，别人也会忽略)</p></blockquote><blockquote><p>每一个互联网用户都置身于AS内，比如中国电信的AS号为4809，那么中国电信的用户就置身于4809的独立王国，如果用户访问的服务器也是在这个AS内，那双向的流量都在王国里来回溜达。</p></blockquote><blockquote><p>但如果服务器IP位于中国移动AS内，如何跨运营商访问呢？</p></blockquote><blockquote><blockquote><p>运营商之间会使用BGP(Border Gateway Protocol)路由协议来交换各自的lP路由表，AS号就是BGP协议用来辨识邻国的一个身份证，同时在交换的路由表信息里，会附上各自的AS号。</p></blockquote></blockquote><blockquote><blockquote><p>既然中国电信通过BGP学习到中国移动的路由信息，就会把用户的访问请求转发给中国移动的边界路由器，既然IP包进入中国移动的地界，接下来就任由中国移动的设备来处理了，假设顺利到达服务器，回程检查客户IP，发现是电信的IP，就会转发到电信的边界路由器，并到达用户。</p></blockquote></blockquote><h2 id=我的asn信息as206729>我的ASN信息——AS206729<a hidden class=anchor aria-hidden=true href=#我的asn信息as206729>#</a></h2><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402OuAhUS.jpg alt=20220402OuAhUS></p><h3 id=as206729-prefixes-v6><strong>AS206729 Prefixes v6</strong><a hidden class=anchor aria-hidden=true href=#as206729-prefixes-v6>#</a></h3><p><code>2401:95c0:f001::/48</code></p><h3 id=as206729-peers-v6><strong>AS206729 Peers v6</strong><a hidden class=anchor aria-hidden=true href=#as206729-peers-v6>#</a></h3><table><thead><tr><th>Rank</th><th>Description</th><th>IPv6</th><th>Peer</th></tr></thead><tbody><tr><td>1</td><td>FranTech Solutions</td><td>2401:95c0:f001::1/128</td><td>AS53667</td></tr></tbody></table><h3 id=更多详情前往bgptoolshttpsbgptoolsas206729查看>更多详情，前往<a href=https://bgp.tools/as/206729>BGP.TOOLS</a>查看。<a hidden class=anchor aria-hidden=true href=#更多详情前往bgptoolshttpsbgptoolsas206729查看>#</a></h3><h2 id=如何申请asn>如何申请ASN<a hidden class=anchor aria-hidden=true href=#如何申请asn>#</a></h2><p>一般情况下，需要寻找<code>APNIC</code>或者<code>RIPE</code>的会员来作为你的<code>LIR</code>。当然你也可以自己加入<code>APNIC</code>或者<code>RIPE</code>，需要每年缴纳费用。</p><p>我找的是台湾的一个朋友 <code>Hostinginside LTD(AS9678)</code>，他作为我的<code>LIR</code>，申请的是<code>RIPE</code>。提供信息到签合同到补全信息，最后下号，花了不到一周的时间。<code>APNIC</code>可能没那么快。</p><h3 id=ripe准备的材料>RIPE准备的材料<a hidden class=anchor aria-hidden=true href=#ripe准备的材料>#</a></h3><ul><li>注册<code>RIPE</code>账号，新建一些 <code>Database</code>的信息。</li><li>你的护照照片</li><li>你在欧洲拥有网络服务的证明（购买的订单截图、机房地址和管理员邮箱）</li><li>ISP愿意给你接入BGP的证明</li><li>两个需要接入的ASN</li></ul><h2 id=asn下号>ASN下号<a hidden class=anchor aria-hidden=true href=#asn下号>#</a></h2><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402qbALxU.jpg alt=20220402qbALxU></p><h2 id=接入bgp-session以buyvm为例vultr类似>接入BGP Session（以BuyVM为例，Vultr类似）<a hidden class=anchor aria-hidden=true href=#接入bgp-session以buyvm为例vultr类似>#</a></h2><ul><li>发<code>Ticket</code>告诉客服你的ASN号，客服一般会向该ASN的管理员邮箱发送一串随机字符串，需要在工单中回复，验证你是ASN的持有人。稍后，客服会在面板里面加入你的ASN和你的IP段。</li></ul><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402T4JgCU.png alt=20220402T4JgCU></p><ul><li>在你的VPS上安装<code>bird</code>。用于宣告你的IP。</li><li>修改 /etc/bird/bird6.conf的配置文件</li><li>修改配置中的 router id 改为自己的IPv4地址</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>router id 205.121.23.12;
</span></span></code></pre></div><ul><li>在文件的最后添加上</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>protocol bgp vultr
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  local as 你的asn(开头不带as);
</span></span><span class=line><span class=cl>  source address 实例的ipv6;
</span></span><span class=line><span class=cl>  import none;
</span></span><span class=line><span class=cl>  export all;
</span></span><span class=line><span class=cl>  graceful restart on;
</span></span><span class=line><span class=cl>  multihop 2;
</span></span><span class=line><span class=cl>  neighbor 2001:19f0:ffff::1 as 64515; #这个是服务器的ip
</span></span><span class=line><span class=cl>  password &#34;在申请广播的时候设置的bgp密码&#34;;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>寻找到protocol static（没有的话自己加一个）</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>protocol static
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  route  [v6前缀] via [实例的IPv6];
</span></span><span class=line><span class=cl>  #route  2001:2333:2333::/48 via 4096:4096:4096:338:5400:01ff:fecf:596c;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>找到protocol direct</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>protocol direct
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  interface &#34;dummy*&#34;;
</span></span><span class=line><span class=cl>  import all;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>配置虚拟网卡以及ip地址</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip link add dev dummy1 type dummy # 添加虚拟网卡
</span></span><span class=line><span class=cl>ip link set dummy1 up
</span></span><span class=line><span class=cl>ip addr add dev dummy1 [前缀内的任意一个地址] # 添加地址
</span></span></code></pre></div><ul><li>启动bird6</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>service bird6 restart
</span></span></code></pre></div><ul><li>查看状态</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>birdc6 show route
</span></span><span class=line><span class=cl>birdc6 show proto all
</span></span></code></pre></div><ul><li>如果想要开机自启 在 <code>/etc/netplan</code>新增<code>01.dummy.yaml</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>network:
</span></span><span class=line><span class=cl>  version: 2
</span></span><span class=line><span class=cl>  renderer: networkd
</span></span><span class=line><span class=cl>  bridges:
</span></span><span class=line><span class=cl>    dummy0:
</span></span><span class=line><span class=cl>      dhcp4: no
</span></span><span class=line><span class=cl>      dhcp6: no
</span></span><span class=line><span class=cl>      accept-ra: no
</span></span><span class=line><span class=cl>      interfaces: [ ]
</span></span><span class=line><span class=cl>      addresses:
</span></span><span class=line><span class=cl>        - 2401:95c0:f001::1/128 #你的IP
</span></span></code></pre></div><h2 id=配置xrayr的出站路由>配置XrayR的出站路由<a hidden class=anchor aria-hidden=true href=#配置xrayr的出站路由>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>    &#34;domainStrategy&#34;: &#34;IPOnDemand&#34;,
</span></span><span class=line><span class=cl>    &#34;rules&#34;: [
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            &#34;type&#34;: &#34;field&#34;,
</span></span><span class=line><span class=cl>            &#34;outboundTag&#34;: &#34;block&#34;,
</span></span><span class=line><span class=cl>            &#34;ip&#34;: [
</span></span><span class=line><span class=cl>                &#34;geoip:private&#34;
</span></span><span class=line><span class=cl>            ]
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            &#34;type&#34;: &#34;field&#34;,
</span></span><span class=line><span class=cl>            &#34;outboundTag&#34;: &#34;block&#34;,
</span></span><span class=line><span class=cl>            &#34;protocol&#34;: [
</span></span><span class=line><span class=cl>                &#34;bittorrent&#34;
</span></span><span class=line><span class=cl>            ]
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>		# 指定域名走我自己的IP
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            &#34;type&#34;: &#34;field&#34;,
</span></span><span class=line><span class=cl>            &#34;outboundTag&#34;: &#34;bgp_session&#34;,
</span></span><span class=line><span class=cl>            &#34;domain&#34;: [&#34;ipv6.ip.sb&#34;]
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>		# Netflix和YouTube走我自己的IP
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            &#34;type&#34;: &#34;field&#34;,
</span></span><span class=line><span class=cl>            &#34;outboundTag&#34;: &#34;bgp_session&#34;,
</span></span><span class=line><span class=cl>            &#34;domain&#34;: [
</span></span><span class=line><span class=cl>                &#34;geosite:netflix&#34;,
</span></span><span class=line><span class=cl>                &#34;geosite:youtube&#34;
</span></span><span class=line><span class=cl>            ]
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    ]
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>##上网测试</p><h3 id=ipsb>IP.SB<a hidden class=anchor aria-hidden=true href=#ipsb>#</a></h3><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402WVLK3S.png alt=20220402WVLK3S></p><h3 id=netflix解锁台湾nf所有片源>Netflix（解锁台湾NF所有片源）<a hidden class=anchor aria-hidden=true href=#netflix解锁台湾nf所有片源>#</a></h3><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402MRa9zP.png alt=20220402MRa9zP></p><h3 id=youtube支持premium-tw>YouTube（支持Premium TW）<a hidden class=anchor aria-hidden=true href=#youtube支持premium-tw>#</a></h3><p><img loading=lazy src=https://static.nisekoo.com/blog/20220402oAFKci.png alt=20220402oAFKci></p><h2 id=参考文章>参考文章<a hidden class=anchor aria-hidden=true href=#参考文章>#</a></h2><p><a href=https://hex.moe/p/d6a20b99/>年轻人的第一个私人BGP(二) - 广播你的IP</a><br><a href=https://blog.ni-co.moe/public/560.html>IP 广播: 使用bird广播(组播)ipv6</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://missuo.me/tags/asn/>ASN</a></li><li><a href=https://missuo.me/tags/bgp/>BGP</a></li><li><a href=https://missuo.me/tags/bird/>Bird</a></li><li><a href=https://missuo.me/tags/linux/>Linux</a></li><li><a href=https://missuo.me/tags/buyvm/>BuyVM</a></li></ul><nav class=paginav><a class=prev href=https://missuo.me/posts/defending-rights-in-china/><span class=title>« Prev</span><br><span>Defending Rights in China</span></a>
<a class=next href=https://missuo.me/posts/2019-hong-kong-travel/><span class=title>Next »</span><br><span>2019 Hong Kong Travel</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://missuo.me>Vincent's Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>